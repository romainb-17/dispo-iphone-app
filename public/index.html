<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Dispo iPhone ‚Äî Apple Stores</title>
  <link rel="stylesheet" href="/styles.css?v=1">
  <meta name="color-scheme" content="light dark">
  <script>
    // Applique le th√®me avant paint (√©vite flash)
    (function(){
      const saved = localStorage.getItem('theme'); // 'light' | 'dark' | null (auto)
      if(saved==='light' || saved==='dark'){ document.documentElement.setAttribute('data-theme', saved); }
      // sinon, on laisse le media-query d√©cider (auto)
    })();
  </script>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="brand">
        <h1 style="margin:0;font-size:20px">üì¶ Dispo iPhone</h1>
        <span class="badge">FR ZD/A</span>
      </div>
      <div class="toolbar">
        <button id="themeToggle" class="theme-btn" aria-label="Basculer th√®me">
          <svg class="theme-icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M12 3a1 1 0 0 1 1 1v1.05a7 7 0 1 1-2 0V4a1 1 0 0 1 1-1zM4 13H3a1 1 0 1 1 0-2h1a1 1 0 1 1 0 2zm17 0h-1a1 1 0 1 1 0-2h1a1 1 0 1 1 0 2zM6.22 6.22a1 1 0 0 1 1.42 0l.74.74a1 1 0 1 1-1.42 1.42l-.74-.74a1 1 0 0 1 0-1.42zM15.62 15.62a1 1 0 0 1 1.42 0l.74.74a1 1 0 1 1-1.42 1.42l-.74-.74a1 1 0 0 1 0-1.42z"/>
          </svg>
          <span id="themeLabel">Auto</span>
        </button>
      </div>
    </div>

    <div class="card">
      <div class="row">
        <div>
          <label>Mod√®le</label><br/>
          <select id="model"><option value="">‚Äî choisir ‚Äî</option></select>
        </div>
        <div>
          <label>Couleur</label><br/>
          <select id="color" disabled><option value="">‚Äî choisir ‚Äî</option></select>
        </div>
        <div>
          <label>Capacit√©</label><br/>
          <select id="capacity" disabled><option value="">‚Äî choisir ‚Äî</option></select>
        </div>
        <div style="align-self:end" class="muted">SKU : <span id="sku" class="sku">(aucun)</span></div>
      </div>

      <div class="row">
        <div>
          <label>Pays</label><br/>
          <select id="country"><option>fr</option><option>be</option><option>ch</option><option>es</option><option>de</option><option>uk</option><option>us</option></select>
        </div>
        <div>
          <label>Localisation (CP/ville ou lat,long)</label><br/>
          <input id="location" placeholder="17000 ou 48.85,2.35" value="17000"/>
        </div>
        <div>
          <label>Store RXXX (optionnel)</label><br/>
          <input id="store" placeholder="R123" style="min-width:100px"/>
        </div>
        <div style="align-self:end">
          <button id="go" class="btn-primary">Rechercher</button>
        </div>
      </div>

      <div class="table-wrap">
        <table>
          <thead><tr><th>Store</th><th>Ville</th><th>Distance</th><th>SKU</th><th>Dispo</th><th>Quote</th></tr></thead>
          <tbody id="tbody"><tr><td colspan="6" class="muted">S√©lectionne un mod√®le puis ‚ÄúRechercher‚Äù.</td></tr></tbody>
        </table>
      </div>

      
<section id="eventsSection" class="card" style="margin-top:16px">
  <div class="row" style="justify-content:space-between;align-items:center;margin:0 0 8px">
    <h2 style="margin:0;font-size:16px">üïí Derniers √©v√©nements (50)</h2>
    <button id="eventsRefresh">Rafra√Æchir</button>
  </div>
  <div class="table-wrap">
    <table>
      <thead>
        <tr><th>Date/heure</th><th>Store</th><th>Ville</th><th>SKU</th><th>Changement</th><th>Quote</th></tr>
      </thead>
      <tbody id="eventsBody"><tr><td colspan="6" class="muted">Chargement‚Ä¶</td></tr></tbody>
    </table>
  </div>
  <p class="muted">Actualisation automatique chaque minute.</p>
</section>

<footer style="margin-top:16px;text-align:center"><a href="https://amzn.to/47Kt0VX" target="_blank" rel="nofollow sponsored noopener" style="font-size:20px;line-height:1.2;font-weight:600">Ach√®te un iPhone sur Amazon</a></footer>
    </div>
  </div>

  <script>
    // Bouton th√®me : Auto ‚Üí Sombre ‚Üí Clair (cycle)
    (function(){
      const btn = document.getElementById('themeToggle');
      const label = document.getElementById('themeLabel');
      function getMode(){
        const v = document.documentElement.getAttribute('data-theme');
        return v === 'dark' ? 'dark' : v === 'light' ? 'light' : 'auto';
      }
      function setMode(mode){
        if(mode==='auto'){ document.documentElement.removeAttribute('data-theme'); localStorage.removeItem('theme'); label.textContent='Auto'; }
        if(mode==='dark'){ document.documentElement.setAttribute('data-theme','dark'); localStorage.setItem('theme','dark'); label.textContent='Sombre'; }
        if(mode==='light'){ document.documentElement.setAttribute('data-theme','light'); localStorage.setItem('theme','light'); label.textContent='Clair'; }
        // meta theme-color pour mobile barre d'adresse
        const mc = document.querySelector('meta[name="theme-color"]') || (function(){ const m=document.createElement('meta'); m.name='theme-color'; document.head.appendChild(m); return m; })();
        const isDark = getMode()==='dark' || (getMode()==='auto' && window.matchMedia('(prefers-color-scheme: dark)').matches);
        mc.setAttribute('content', isDark ? '#0b0f19' : '#fafafa');
      }
      btn.addEventListener('click', ()=>{
        const order = ['auto','dark','light'];
        const next = order[(order.indexOf(getMode())+1)%order.length];
        setMode(next);
      });
      setMode(getMode()); // init
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', ()=>{ if(getMode()==='auto') setMode('auto'); });
    })();
  </script>

  <script src="/app.js" type="module"></script>
</body>
</html>
